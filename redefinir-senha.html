<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Redefinir Senha ‚Äî AutoMEItizado</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=IBM+Plex+Mono:wght@300;400;500;600&family=Barlow:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<style>
:root,[data-theme="light"]{--paper:#F0ECE3;--paper2:#E6E1D6;--paper3:#D8D2C5;--ink:#0C0C0A;--ink2:#3A3830;--ink3:#7A7568;--lime:#C8FF00;--lime2:#A8D800;--red:#FF2800;--green:#00A86B;--border:#0C0C0A;--border-light:#C0BAB0;--input-bg:#fff;--input-border:#C0BAB0;--input-focus-shadow:#0C0C0A;--btn-buy-bg:var(--ink);--btn-buy-color:var(--lime);--btn-buy-hover-bg:#1a1a18;--btn-buy-hover-shadow:var(--lime);--section-border:var(--ink);--notice-gold-bg:rgba(200,160,0,0.06);--notice-gold-border:#B8960A;--notice-gold-color:var(--ink2);--notice-gold-strong:#8A6F00;--link-color:var(--ink);--footer-border:var(--ink);--toggle-bg:var(--ink);--toggle-color:var(--lime);--toggle-hover-bg:var(--lime);--toggle-hover-color:var(--ink);}
[data-theme="dark"]{--paper:#0a0a08;--paper2:#121210;--paper3:#1e1e18;--ink:#f0f0e6;--ink2:#c0c0b0;--ink3:#808070;--lime:#C8FF00;--lime2:#A8D800;--red:#FF5F5F;--green:#6FCF97;--border:#404036;--border-light:#5a5a4a;--input-bg:#1a1a16;--input-border:#404036;--input-focus-shadow:rgba(200,255,0,0.2);--btn-buy-bg:var(--lime);--btn-buy-color:#0a0a08;--btn-buy-hover-bg:#d8ff30;--btn-buy-hover-shadow:#0a0a08;--section-border:#404036;--notice-gold-bg:rgba(200,255,0,0.05);--notice-gold-border:var(--lime);--notice-gold-color:var(--ink2);--notice-gold-strong:var(--lime);--link-color:var(--lime);--footer-border:#404036;--toggle-bg:var(--lime);--toggle-color:#0a0a08;--toggle-hover-bg:var(--ink);--toggle-hover-color:var(--lime);}

.theme-toggle{position:fixed;bottom:28px;right:28px;z-index:9999;width:42px;height:42px;background:var(--toggle-bg);color:var(--toggle-color);border:2px solid var(--border);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;transition:background .2s,color .2s,transform .15s;font-family:'IBM Plex Mono',monospace;}
.theme-toggle:hover{background:var(--toggle-hover-bg);color:var(--toggle-hover-color);transform:scale(1.08);}

*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--paper);color:var(--ink);font-family:'Barlow',sans-serif;line-height:1.5;-webkit-font-smoothing:antialiased;min-height:100vh;transition:background .2s,color .2s;display:flex;flex-direction:column;}
body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");pointer-events:none;z-index:0;opacity:.55;}

.page{position:relative;z-index:1;max-width:1280px;margin:0 auto;padding:0 40px;flex:1;display:flex;flex-direction:column;}

/* TOPBAR */
.topbar{border-bottom:2px solid var(--section-border);padding:20px 0;display:flex;align-items:center;justify-content:space-between;}
.logo{display:flex;align-items:center;gap:12px;}
.logo-mark{width:36px;height:36px;background:var(--ink);display:flex;align-items:center;justify-content:center;font-family:'IBM Plex Mono',monospace;font-size:13px;font-weight:600;color:var(--lime);letter-spacing:-1px;}
[data-theme="dark"] .logo-mark{background:var(--lime);color:#0a0a08;}
.logo-text{font-family:'Barlow',sans-serif;font-size:15px;font-weight:700;color:var(--ink);letter-spacing:-.01em;}
.logo-sub{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--ink3);letter-spacing:.06em;text-transform:uppercase;}
.topbar-right{display:flex;align-items:center;gap:16px;}
.status-stamp{display:flex;align-items:center;gap:7px;border:1.5px solid var(--green);padding:5px 12px;font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--green);letter-spacing:.12em;text-transform:uppercase;font-weight:600;}
.status-dot{width:5px;height:5px;background:var(--green);border-radius:50%;animation:blink 1.8s ease infinite;}
@keyframes blink{0%,100%{opacity:1;}50%{opacity:.3;}}
.ver-badge{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--ink3);letter-spacing:.1em;text-transform:uppercase;background:var(--paper2);border:1px solid var(--border-light);padding:5px 10px;}

/* TICKER */
.ticker{border-top:2px solid var(--section-border);border-bottom:2px solid var(--section-border);padding:9px 0;overflow:hidden;font-family:'Bebas Neue',cursive;font-size:12px;letter-spacing:.22em;color:var(--border-light);white-space:nowrap;animation:fadeUp .45s ease both;}

/* SECTION RULE */
.section-rule{display:flex;align-items:center;gap:0;margin:40px 0 0;border-top:2px solid var(--section-border);padding-top:12px;animation:fadeUp .45s .05s ease both;opacity:0;animation-fill-mode:both;}
.section-rule-label{font-family:'Bebas Neue',cursive;font-size:28px;letter-spacing:.08em;color:var(--ink);flex:1;}
.section-rule-num{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--ink3);letter-spacing:.12em;text-transform:uppercase;}

/* GRID */
.main-grid{display:grid;grid-template-columns:1fr 1fr;gap:0;border:2px solid var(--section-border);margin:32px 0 80px;animation:fadeUp .45s .12s ease both;opacity:0;animation-fill-mode:both;}

/* LEFT */
.info-panel{padding:52px 48px;border-right:2px solid var(--section-border);display:flex;flex-direction:column;justify-content:space-between;position:relative;overflow:hidden;}
.info-panel::after{content:'SEGURAN√áA ¬∑ SEGURAN√áA ¬∑ SEGURAN√áA ¬∑ SEGURAN√áA ¬∑ SEGURAN√áA ¬∑ SEGURAN√áA ¬∑ SEGURAN√áA ¬∑';position:absolute;bottom:14px;left:0;right:0;font-family:'Bebas Neue',cursive;font-size:11px;letter-spacing:.22em;color:var(--border-light);white-space:nowrap;overflow:hidden;opacity:.45;}
.info-tag{display:inline-block;background:var(--lime);color:#0a0a08;font-family:'IBM Plex Mono',monospace;font-size:10px;font-weight:600;letter-spacing:.18em;text-transform:uppercase;padding:4px 10px;margin-bottom:24px;width:fit-content;}
[data-theme="light"] .info-tag{color:var(--ink);}
.info-title{font-family:'Bebas Neue',cursive;font-size:clamp(3.5rem,4.5vw,5.5rem);line-height:.92;letter-spacing:-.01em;color:var(--ink);}
.info-title .outline{-webkit-text-stroke:2px var(--ink);color:transparent;}
.info-desc{font-size:15px;color:var(--ink2);line-height:1.65;margin-top:20px;max-width:340px;}
.info-desc strong{color:var(--ink);font-weight:700;}

.info-steps{margin-top:36px;border-top:1.5px solid var(--border-light);padding-top:20px;}
.info-step{display:flex;align-items:flex-start;gap:14px;margin-bottom:16px;}
.info-step-num{font-family:'IBM Plex Mono',monospace;font-size:10px;font-weight:600;color:var(--lime);background:var(--ink);width:22px;height:22px;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
[data-theme="dark"] .info-step-num{background:var(--lime);color:#0a0a08;}
.info-step-text{font-size:13px;color:var(--ink2);line-height:1.55;}
.info-step-text strong{color:var(--ink);font-weight:600;}

/* RIGHT */
.form-panel{padding:52px 48px;background:var(--paper2);}
.form-heading{font-family:'Bebas Neue',cursive;font-size:32px;letter-spacing:.06em;color:var(--ink);margin-bottom:8px;padding-bottom:16px;border-bottom:1.5px solid var(--border-light);}
.form-sub{font-size:14px;color:var(--ink2);margin-bottom:32px;line-height:1.6;}

.form-group{margin-bottom:20px;}
label{display:block;font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.14em;text-transform:uppercase;color:var(--ink2);margin-bottom:8px;font-weight:500;}
input[type=email],input[type=password]{width:100%;padding:12px 14px;background:var(--input-bg);border:1.5px solid var(--input-border);border-radius:0;color:var(--ink);font-size:14px;font-family:'Barlow',sans-serif;font-weight:500;transition:border-color .12s,box-shadow .12s;}
input[type=email]::placeholder,input[type=password]::placeholder{color:var(--ink3);font-weight:400;}
input[type=email]:focus,input[type=password]:focus{outline:none;border-color:var(--lime);box-shadow:3px 3px 0 var(--input-focus-shadow);}

/* Strength */
.strength-track{height:3px;background:var(--border);margin-top:8px;}
.strength-fill{height:100%;width:0%;transition:width .3s,background .3s;}
.strength-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--ink3);margin-top:5px;}

.match-msg{font-family:'IBM Plex Mono',monospace;font-size:11px;margin-top:6px;min-height:16px;letter-spacing:.04em;}
.match-msg.ok{color:var(--green);}
.match-msg.err{color:var(--red);}

.feedback{color:var(--red);font-size:12px;font-family:'IBM Plex Mono',monospace;letter-spacing:.04em;margin-bottom:12px;min-height:20px;}
.feedback.success{color:var(--green);}

/* Buttons */
.btn-comprar{width:100%;padding:16px;background:var(--btn-buy-bg);border:none;color:var(--btn-buy-color);font-family:'Bebas Neue',cursive;font-size:22px;letter-spacing:.12em;cursor:pointer;transition:all .12s;margin-top:10px;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;gap:8px;}
.btn-comprar::after{content:'‚Üí';font-family:'Barlow',sans-serif;font-size:20px;transition:transform .2s;}
.btn-comprar:hover:not(:disabled){background:var(--btn-buy-hover-bg);box-shadow:4px 4px 0 var(--btn-buy-hover-shadow);transform:translate(-2px,-2px);}
.btn-comprar:hover::after{transform:translateX(4px);}
.btn-comprar:disabled{background:var(--border);color:var(--ink3);cursor:not-allowed;}
.btn-comprar:disabled::after{display:none;}
.btn-sec{width:100%;padding:12px;background:transparent;border:1.5px solid var(--border-light);color:var(--ink2);font-family:'Barlow',sans-serif;font-size:14px;font-weight:600;cursor:pointer;transition:all .12s;margin-top:8px;}
.btn-sec:hover{border-color:var(--lime);color:var(--ink);}
[data-theme="dark"] .btn-sec:hover{color:var(--lime);}

/* Notice */
.notice-gold{padding:14px 16px;font-size:13px;line-height:1.65;border-left:3px solid var(--notice-gold-border);background:var(--notice-gold-bg);color:var(--notice-gold-color);margin-bottom:20px;}
.notice-gold strong{color:var(--notice-gold-strong);}

/* Success */
.sucesso-view{text-align:center;padding:48px 0;}
.sucesso-stamp{display:inline-block;font-family:'Bebas Neue',cursive;font-size:80px;line-height:1;color:var(--lime);letter-spacing:-.02em;border:3px solid var(--lime);padding:0 24px;margin-bottom:24px;animation:popIn .4s cubic-bezier(.175,.885,.32,1.275) both;}
@keyframes popIn{from{transform:scale(.6);opacity:0;}to{transform:scale(1);opacity:1;}}
.sucesso-view h3{font-family:'Bebas Neue',cursive;font-size:32px;letter-spacing:.06em;color:var(--ink);margin-bottom:12px;}
.sucesso-view p{color:var(--ink2);font-size:14px;line-height:1.65;}

/* Footer */
.page-footer{text-align:center;padding:28px 0 40px;font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.16em;text-transform:uppercase;color:var(--ink3);border-top:2px solid var(--footer-border);}

@keyframes fadeUp{from{opacity:0;transform:translateY(16px);}to{opacity:1;transform:translateY(0);}}

#view-solicitar{display:block;}
#view-redefinir{display:none;}
#view-sucesso{display:none;}

@media(max-width:900px){.main-grid{grid-template-columns:1fr;}.info-panel{border-right:none;border-bottom:2px solid var(--section-border);padding:40px 32px 52px;}.form-panel{padding:40px 32px;}}
@media(max-width:640px){.page{padding:0 20px;}.info-title{font-size:3.5rem;}.form-panel,.info-panel{padding:32px 22px;}.main-grid{margin-bottom:48px;}}
</style>
</head>
<body>

<button class="theme-toggle" id="themeToggle" title="Alternar tema">‚òÄÔ∏è</button>

<div class="page">

  <div class="topbar">
    <div class="logo">
      <div class="logo-mark">PG</div>
      <div>
        <div class="logo-text">AutoMEItizado</div>
        <div class="logo-sub">Extens√£o para Chrome</div>
      </div>
    </div>
    <div class="topbar-right">
      <div class="status-stamp"><div class="status-dot"></div>Sistema ativo</div>
      <div class="ver-badge">v2026</div>
    </div>
  </div>

  <div class="ticker">RECUPERAR ACESSO ¬∑ NOVA SENHA ¬∑ SEGURAN√áA ¬∑ RECUPERAR ACESSO ¬∑ NOVA SENHA ¬∑ SEGURAN√áA ¬∑ RECUPERAR ACESSO ¬∑ NOVA SENHA ¬∑ SEGURAN√áA ¬∑ RECUPERAR ACESSO ¬∑ NOVA SENHA ¬∑ SEGURAN√áA ¬∑</div>

  <div class="section-rule">
    <div class="section-rule-label">Redefinir Senha</div>
    <div class="section-rule-num">Recupera√ß√£o de acesso</div>
  </div>

  <div class="main-grid">
    <!-- LEFT INFO -->
    <div class="info-panel">
      <div>
        <div class="info-tag">Seguran√ßa da conta</div>
        <div class="info-title">
          ACESSO<br>
          <span class="outline">SEGURO</span><br>
          2026
        </div>
        <p class="info-desc">Recupere seu acesso em segundos.<br><strong>Sua conta est√° protegida</strong> com criptografia e autentica√ß√£o segura.</p>
        <div class="info-steps">
          <div class="info-step">
            <div class="info-step-num">01</div>
            <div class="info-step-text"><strong>Informe seu e-mail</strong> ‚Äî o mesmo usado no cadastro</div>
          </div>
          <div class="info-step">
            <div class="info-step-num">02</div>
            <div class="info-step-text"><strong>Abra o link</strong> enviado para sua caixa de entrada</div>
          </div>
          <div class="info-step">
            <div class="info-step-num">03</div>
            <div class="info-step-text"><strong>Crie uma nova senha</strong> e volte a usar a extens√£o</div>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT FORM -->
    <div class="form-panel">

      <div id="view-solicitar">
        <div class="form-heading">Solicitar link</div>
        <p class="form-sub">Informe o e-mail da sua conta para receber o link de recupera√ß√£o.</p>
        <form id="form-reset" novalidate>
          <div class="form-group">
            <label for="email">E-mail cadastrado</label>
            <input type="email" id="email" placeholder="seu@email.com" autocomplete="email">
          </div>
          <div class="feedback" id="mensagem"></div>
          <button type="submit" class="btn-comprar" id="btn-reset">Enviar link de recupera√ß√£o</button>
        </form>
      </div>

      <div id="view-redefinir">
        <div class="form-heading">Nova senha</div>
        <p class="form-sub">Escolha uma senha forte para proteger seu acesso.</p>
        <div class="notice-gold"><strong>Requisitos:</strong> m√≠nimo 8 caracteres, com mai√∫scula, min√∫scula, n√∫mero e s√≠mbolo.</div>
        <div class="form-group">
          <label for="nova-senha">Nova senha</label>
          <input type="password" id="nova-senha" placeholder="M√≠nimo 8 caracteres" autocomplete="new-password" oninput="verificar()">
          <div class="strength-track"><div class="strength-fill" id="strength-fill"></div></div>
          <div class="strength-label" id="strength-label">‚Äî</div>
        </div>
        <div class="form-group">
          <label for="confirmar-senha">Confirmar senha</label>
          <input type="password" id="confirmar-senha" placeholder="Repita a senha" autocomplete="new-password" oninput="verificar()">
          <div class="match-msg" id="match-msg"></div>
        </div>
        <div class="feedback" id="erro"></div>
        <button class="btn-comprar" id="btn-salvar" onclick="salvarSenha()">Salvar nova senha</button>
        <button class="btn-sec" onclick="mostrarSolicitar()">‚Üê Voltar ao in√≠cio</button>
      </div>

      <div id="view-sucesso" class="sucesso-view">
        <div class="sucesso-stamp">‚úì</div>
        <h3 id="sucesso-titulo">Senha alterada!</h3>
        <p id="sucesso-texto">Abra a extens√£o do Chrome e fa√ßa login com sua nova senha para continuar.</p>
      </div>

    </div>
  </div>

  <div class="page-footer">AutoMEItizado ¬∑ PGMEI Automa√ß√£o 2026 ¬∑ Todos os direitos reservados</div>
</div>

<script>
const EDGE_RECOVER='https://kzhoezukwpllgcxzkkbr.supabase.co/functions/v1/recover-password';
const EDGE_RESET='https://kzhoezukwpllgcxzkkbr.supabase.co/functions/v1/reset-password-confirm';

// THEME
const html=document.documentElement;
document.getElementById('themeToggle').addEventListener('click',()=>{
  const d=html.getAttribute('data-theme')==='dark';
  html.setAttribute('data-theme',d?'light':'dark');
  document.getElementById('themeToggle').textContent=d?'üåô':'‚òÄÔ∏è';
});

// SOLICITAR
document.getElementById('form-reset').addEventListener('submit',async(e)=>{
  e.preventDefault();
  const email=document.getElementById('email').value.trim();
  const btn=document.getElementById('btn-reset');
  const msg=document.getElementById('mensagem');
  if(!email){msg.textContent='‚ö† Insira seu e-mail.';msg.className='feedback';return;}
  btn.disabled=true;btn.textContent='Enviando...';msg.textContent='';msg.className='feedback';
  try{
    const res=await fetch(EDGE_RECOVER,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email})});
    const data=await res.json();
    if(!res.ok)throw new Error(data.error||'Erro ao solicitar redefini√ß√£o.');
    msg.textContent=data.message||'Se o e-mail estiver cadastrado, voc√™ receber√° o link em breve.';
    msg.className='feedback success';btn.textContent='‚úì Link enviado!';
  }catch(err){msg.textContent='‚úï '+err.message;msg.className='feedback';btn.disabled=false;btn.textContent='Enviar link de recupera√ß√£o';}
});

// TOKEN
const tokenData=(()=>{
  const params=new URLSearchParams(window.location.hash.substring(1));
  const result={access_token:params.get('access_token'),type:params.get('type')};
  if(result.access_token){try{window.history.replaceState(null,'',window.location.pathname+window.location.search);}catch(_){}}
  return result;
})();

if(tokenData.access_token&&tokenData.type==='recovery'){
  document.getElementById('view-solicitar').style.display='none';
  document.getElementById('view-redefinir').style.display='block';
}else if(window.location.hash.includes('error=')){
  const p=new URLSearchParams(window.location.hash.substring(1));
  const msg=document.getElementById('mensagem');
  msg.textContent='‚úï '+(decodeURIComponent((p.get('error_description')||'Link inv√°lido.').replace(/\+/g,' ')));
  msg.className='feedback';
}

function mostrarSolicitar(){document.getElementById('view-redefinir').style.display='none';document.getElementById('view-solicitar').style.display='block';}

function verificar(){
  const s1=document.getElementById('nova-senha').value;
  const s2=document.getElementById('confirmar-senha').value;
  const msg=document.getElementById('match-msg');
  const fill=document.getElementById('strength-fill');
  const lbl=document.getElementById('strength-label');
  let sc=0;
  if(s1.length>=8)sc++;if(/[A-Z]/.test(s1))sc++;if(/[0-9]/.test(s1))sc++;if(/[^A-Za-z0-9]/.test(s1))sc++;
  const clr=['#404036','#FF5F5F','#FFCC00','#A8D800','#C8FF00'];
  const lbs=['‚Äî','FRACA','M√âDIA','BOA','FORTE'];
  fill.style.width=(sc/4*100)+'%';fill.style.background=clr[sc];lbl.textContent=s1?lbs[sc]:'‚Äî';
  if(!s2){msg.textContent='';return;}
  if(s1===s2){msg.textContent='‚úì Senhas conferem';msg.className='match-msg ok';}
  else{msg.textContent='‚úï Senhas n√£o conferem';msg.className='match-msg err';}
}

async function salvarSenha(){
  const nova=document.getElementById('nova-senha').value;
  const confirma=document.getElementById('confirmar-senha').value;
  const erroEl=document.getElementById('erro');
  erroEl.textContent='';
  const vld=s=>s.length>=8&&/[A-Z]/.test(s)&&/[a-z]/.test(s)&&/[0-9]/.test(s)&&/[^A-Za-z0-9]/.test(s);
  if(!vld(nova)){erroEl.textContent='‚ö† Senha: mai√∫scula, min√∫scula, n√∫mero e s√≠mbolo.';return;}
  if(nova!==confirma){erroEl.textContent='‚ö† As senhas n√£o conferem.';return;}
  if(!tokenData.access_token){erroEl.textContent='‚úï Link inv√°lido ou expirado.';return;}
  const btn=document.getElementById('btn-salvar');
  btn.disabled=true;btn.textContent='Salvando...';
  try{
    const res=await fetch(EDGE_RESET,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({access_token:tokenData.access_token,nova_senha:nova})});
    const data=await res.json();
    if(!res.ok)throw new Error(data.error||'Erro ao salvar nova senha.');
    document.getElementById('nova-senha').value='';document.getElementById('confirmar-senha').value='';
    document.getElementById('view-redefinir').style.display='none';
    document.getElementById('view-sucesso').style.display='block';
  }catch(err){erroEl.textContent='‚úï '+err.message;btn.disabled=false;btn.textContent='Salvar nova senha';}
}
</script>
</body>
</html>