<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>PGMEI Automa√ß√£o ‚Äî Escolha seu plano</title>
<!-- VUL-07 CORRIGIDO: Content Security Policy -->
<meta http-equiv="Content-Security-Policy"
  content="default-src 'self';
           script-src 'self' https://js.stripe.com;
           style-src 'self' https://fonts.googleapis.com 'unsafe-inline';
           font-src https://fonts.gstatic.com;
           connect-src https://*.supabase.co https://api.stripe.com;
           frame-src https://js.stripe.com;
           img-src 'self' data:;"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800;900&family=DM+Mono:wght@400;500&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"><style>
 :root {
 --bg: #0a0a0a;
 --bg2: #111111;
 --text: #f8fafc;
 --muted: #64748b;
 --muted2: #94a3b8;
 --border: #1e293b;
 --border2: #334155;
 --accent: #f0a500;
 --accent2: #fbbf24;
 --accent3: #fde047;
 --green: #22c55e;
 --red: #ef4444;
 --purple: #8b5cf6;
 }
 * { margin: 0; padding: 0; box-sizing: border-box; }
 body { background: var(--bg); color: var(--text); font-family: 'Instrument Sans', sans-serif; line-height: 1.6; -webkit-font-smoothing: antialiased; }
 .grid-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(rgba(240,165,0,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(240,165,0,0.03) 1px, transparent 1px); background-size: 48px 48px; pointer-events: none; z-index: 0; }

 .hero { padding: 64px 24px 40px; text-align: center; position: relative; z-index: 1; }
 .hero-badge { display: inline-block; background: rgba(240,165,0,0.08); border: 1px solid rgba(240,165,0,0.2); border-radius: 20px; padding: 6px 14px; font-family: 'DM Mono', monospace; font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--accent); margin-bottom: 28px; }
 .hero h1 { font-family: 'Syne', sans-serif; font-size: 2.5rem; font-weight: 900; line-height: 1.1; margin-bottom: 16px; letter-spacing: -0.03em; }
 .hero h1 em { color: var(--accent); font-style: normal; }
 .hero p { font-size: 1.05rem; color: var(--muted2); max-width: 540px; margin: 0 auto 32px; }
 .hero-features { display: flex; justify-content: center; flex-wrap: wrap; gap: 12px; }
 .hero-feat { background: var(--bg2); border: 1px solid var(--border); border-radius: 20px; padding: 8px 16px; font-family: 'DM Mono', monospace; font-size: 11px; letter-spacing: 0.08em; text-transform: uppercase; color: var(--muted); }

 .billing-cycle-section { padding: 0 24px 24px; position: relative; z-index: 1; }
 .billing-cycle-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
 .billing-cycle-btn { padding: 10px 20px; background: var(--bg2); border: 1px solid var(--border); border-radius: 8px; color: var(--muted); font-family: 'DM Mono', monospace; font-size: 12px; font-weight: 500; letter-spacing: 0.05em; cursor: pointer; transition: all 0.2s; text-transform: uppercase; position: relative; }
 .billing-cycle-btn:hover { border-color: var(--border2); color: var(--text); }
 .billing-cycle-btn.active { background: var(--accent); border-color: var(--accent); color: #000; }
 .discount-badge { position: absolute; top: -8px; right: -8px; background: var(--green); color: #000; font-size: 9px; font-weight: 700; padding: 2px 5px; border-radius: 4px; font-family: 'Syne', sans-serif; }

 @keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }

 .section-label { text-align: center; font-family: 'DM Mono', monospace; font-size: 10px; letter-spacing: 0.18em; text-transform: uppercase; color: var(--accent); margin-bottom: 24px; position: relative; z-index: 1; }

 .plans-section { padding: 24px 24px 40px; position: relative; z-index: 1; }
 .plans { display: grid; grid-template-columns: repeat(auto-fit, minmax(156px, 1fr)); gap: 12px; max-width: 1200px; margin: 0 auto; }

 .plan-card { position: relative; background: var(--bg2); border: 1px solid var(--border); border-radius: 12px; padding: 22px 18px 20px; cursor: pointer; transition: border-color 0.2s, transform 0.2s, box-shadow 0.2s, background 0.2s; text-align: left; overflow: hidden; }
 .plan-card::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(240,165,0,0.06) 0%, transparent 60%); opacity: 0; transition: opacity 0.2s; }
 .plan-card:hover { border-color: var(--border2); transform: translateY(-3px); box-shadow: 0 12px 40px rgba(0,0,0,0.4); }
 .plan-card:hover::before { opacity: 1; }
 .plan-card.selected { border-color: var(--accent); background: #131a10; box-shadow: 0 0 0 1px var(--accent3), 0 8px 32px rgba(240,165,0,0.15); transform: translateY(-3px); }
 .plan-card.selected::before { opacity: 1; }

 .plan-card.personalizado { border-color: rgba(139,92,246,0.3); }
 .plan-card.personalizado::before { background: linear-gradient(135deg, rgba(139,92,246,0.06) 0%, transparent 60%); }
 .plan-card.personalizado:hover { border-color: var(--purple); }
 .plan-card.personalizado.selected { border-color: var(--purple); background: #120f1a; box-shadow: 0 0 0 1px var(--purple), 0 8px 32px rgba(139,92,246,0.15); }

 .popular-tag { display: inline-block; background: var(--accent); color: #000; font-family: 'Syne', sans-serif; font-size: 9px; font-weight: 800; letter-spacing: 0.1em; text-transform: uppercase; padding: 3px 8px; border-radius: 4px; margin-bottom: 12px; }
 .custom-tag { display: inline-block; background: var(--purple); color: white; font-family: 'Syne', sans-serif; font-size: 9px; font-weight: 800; letter-spacing: 0.1em; text-transform: uppercase; padding: 3px 8px; border-radius: 4px; margin-bottom: 12px; }

 .plan-name { font-family: 'Syne', sans-serif; font-size: 1rem; font-weight: 800; color: var(--text); margin-bottom: 4px; letter-spacing: -0.01em; }
 .plan-limit { font-family: 'DM Mono', monospace; font-size: 10px; color: var(--muted); margin-bottom: 16px; letter-spacing: 0.04em; }
 .plan-price { font-family: 'Syne', sans-serif; font-size: 1.5rem; font-weight: 900; color: var(--accent); letter-spacing: -0.03em; line-height: 1; }
 .plan-card.personalizado .plan-price { color: var(--purple); font-size: 1.1rem; }
 .plan-price span { font-size: 0.7rem; font-weight: 400; color: var(--muted); font-family: 'DM Mono', monospace; letter-spacing: 0; }
 .plan-billing { font-family: 'DM Mono', monospace; font-size: 10px; color: var(--muted); margin-top: 4px; }
 .plan-overage { font-family: 'DM Mono', monospace; font-size: 9px; color: var(--purple); margin-top: 4px; }
 .plan-savings { font-family: 'DM Mono', monospace; font-size: 9px; color: var(--green); margin-top: 4px; font-weight: 500; }

 .plan-check { position: absolute; top: 14px; right: 14px; width: 20px; height: 20px; border: 1.5px solid var(--border2); border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.2s; background: var(--bg); }
 .plan-card.selected .plan-check { background: var(--accent); border-color: var(--accent); color: #000; font-size: 11px; }
 .plan-card.personalizado.selected .plan-check { background: var(--purple); border-color: var(--purple); color: white; }

 .sep { max-width: 1200px; margin: 0 auto 40px; padding: 0 24px; position: relative; z-index: 1; display: flex; align-items: center; gap: 16px; }
 .sep::before, .sep::after { content: ''; flex: 1; height: 1px; background: linear-gradient(90deg, transparent, var(--border2), transparent); }
 .sep span { font-family: 'DM Mono', monospace; font-size: 10px; letter-spacing: 0.15em; text-transform: uppercase; color: var(--muted); white-space: nowrap; }

 .form-section { max-width: 480px; margin: 0 auto; padding: 0 20px 80px; position: relative; z-index: 1; }
 .form-card { background: var(--bg2); border: 1px solid var(--border); border-radius: 16px; padding: 36px 32px; position: relative; overflow: hidden; }
 .form-card::before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 280px; height: 2px; background: linear-gradient(90deg, transparent, var(--accent), transparent); }
 .form-title { font-family: 'Syne', sans-serif; font-size: 1.15rem; font-weight: 800; color: var(--text); margin-bottom: 28px; letter-spacing: -0.02em; display: flex; align-items: center; gap: 10px; }
 .form-title-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--accent3), var(--accent)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
 .plano-selecionado { background: rgba(240,165,0,0.07); border: 1px solid rgba(240,165,0,0.25); border-radius: 10px; padding: 12px 16px; margin-bottom: 24px; display: flex; justify-content: space-between; align-items: center; font-size: 13px; color: var(--muted2); }
 .plano-selecionado strong { font-family: 'DM Mono', monospace; color: var(--accent); font-weight: 500; }
 .aviso-email { background: rgba(255,190,58,0.07); border: 1px solid rgba(255,190,58,0.3); border-radius: 10px; padding: 14px 16px; margin-bottom: 20px; font-size: 13px; color: #f5d070; line-height: 1.6; }
 .aviso-personalizado { background: rgba(139,92,246,0.07); border: 1px solid rgba(139,92,246,0.3); border-radius: 10px; padding: 20px; margin-bottom: 24px; font-size: 13px; color: #c4b5fd; line-height: 1.7; }
 .aviso-personalizado strong { color: var(--purple); }
 .aviso-personalizado .btn-wpp { display: inline-block; margin-top: 14px; width: 100%; padding: 13px; background: #25D366; border: none; border-radius: 10px; color: white; font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 800; cursor: pointer; text-align: center; text-decoration: none; transition: all 0.2s; }
 .aviso-personalizado .btn-wpp:hover { background: #1ebe5d; transform: translateY(-1px); }

 .form-group { margin-bottom: 18px; }
 label { display: block; font-size: 11px; font-family: 'DM Mono', monospace; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-bottom: 8px; font-weight: 500; }
 .label-row { display: flex; justify-content: space-between; align-items: center; }
 .label-optional { font-size: 10px; color: var(--border2); text-transform: none; letter-spacing: 0; font-style: italic; font-family: 'Instrument Sans', sans-serif; }
 input { width: 100%; padding: 12px 14px; background: var(--bg); border: 1px solid var(--border2); border-radius: 8px; color: var(--text); font-size: 14px; font-family: 'Instrument Sans', sans-serif; transition: border-color 0.2s, box-shadow 0.2s; }
 input::placeholder { color: var(--muted); }
 input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(240,165,0,0.1); }
 input.erro-campo { border-color: var(--red); }
 input.ok-campo { border-color: var(--green); }
 .doc-tabs { display: flex; gap: 6px; margin-bottom: 8px; }
 .doc-tab { flex: 1; padding: 8px; background: var(--bg); border: 1px solid var(--border2); border-radius: 7px; color: var(--muted); font-size: 11px; font-family: 'DM Mono', monospace; font-weight: 500; letter-spacing: 0.08em; cursor: pointer; text-align: center; transition: all 0.15s; text-transform: uppercase; }
 .doc-tab.active { background: var(--accent); border-color: var(--accent); color: #000; }
 hr.divider { border: none; border-top: 1px solid var(--border); margin: 24px 0; }
 .erro { color: var(--red); font-size: 13px; margin-top: 8px; min-height: 20px; }
 

 .btn-comprar { width: 100%; padding: 15px; background: linear-gradient(135deg, var(--accent3), var(--accent2)); border: none; border-radius: 10px; color: #000; font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 800; letter-spacing: -0.01em; cursor: pointer; transition: all 0.2s; margin-top: 8px; position: relative; overflow: hidden; }
 .btn-comprar::after { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.15) 50%, transparent 100%); opacity: 0; transition: opacity 0.2s; }
 .btn-comprar:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(240,165,0,0.35); }
 .btn-comprar:hover:not(:disabled)::after { opacity: 1; }
 .btn-comprar:disabled { background: var(--border2); color: var(--muted); cursor: not-allowed; }
 .btn-sec { width: 100%; padding: 12px; background: transparent; border: 1px solid var(--border2); border-radius: 10px; color: var(--muted2); font-family: 'Instrument Sans', sans-serif; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s; margin-top: 8px; }
 .btn-sec:hover { border-color: var(--accent); color: var(--accent); }
 .link { color: var(--accent); text-decoration: underline; cursor: pointer; font-size: 13px; }
 .link:hover { color: var(--accent2); }
 .seguro { display: flex; align-items: center; justify-content: center; gap: 6px; color: var(--muted); font-size: 11px; font-family: 'DM Mono', monospace; margin-top: 16px; }

 .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75); z-index: 200; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
 .modal-overlay.aberto { display: flex; }
 .modal { background: var(--bg2); border: 1px solid var(--border2); border-radius: 16px; padding: 36px; max-width: 400px; width: 90%; position: relative; animation: modalIn 0.25s ease both; }
 @keyframes modalIn { from { opacity: 0; transform: scale(0.95) translateY(8px); } to { opacity: 1; transform: scale(1) translateY(0); } }
 .modal::before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 180px; height: 1px; background: linear-gradient(90deg, transparent, var(--accent), transparent); }
 .modal h3 { font-family: 'Syne', sans-serif; font-size: 1.1rem; font-weight: 800; color: var(--text); margin-bottom: 8px; letter-spacing: -0.02em; }
 .modal p { color: var(--muted2); font-size: 13px; margin-bottom: 24px; line-height: 1.6; }
 .modal-btns { display: flex; gap: 8px; margin-top: 16px; }
 .modal-btns button { flex: 1; }
 .modal-btns .btn-comprar { margin: 0; }
 .modal-btns .btn-sec { margin: 0; }

 .page-footer { text-align: center; padding: 24px; font-family: 'DM Mono', monospace; font-size: 10px; letter-spacing: 0.12em; text-transform: uppercase; color: var(--border2); position: relative; z-index: 1; }

 @media(max-width: 600px) {
 .form-card { padding: 28px 20px; }
 .plans { grid-template-columns: repeat(2, 1fr); }
 .hero h1 { font-size: 2rem; }
 .billing-cycle-container { gap: 6px; }
 .billing-cycle-btn { padding: 8px 14px; font-size: 11px; }
 }
 @media(max-width: 360px) { .plans { grid-template-columns: 1fr; } }
</style></head><body><div class="grid-bg"></div><div class="modal-overlay" id="modal-senha"><div class="modal"><h3>Recuperar senha</h3><p>Digite seu email e enviaremos um link para criar uma nova senha.</p><div class="form-group"><label>Email</label><input type="email" id="modal-email" placeholder="seuemail@exemplo.com"></div><div id="modal-erro" class="erro"></div><div id="modal-sucesso" style="display:none; color:var(--green); font-size:13px; margin-top:8px; font-family:'DM Mono',monospace;">‚úì Email enviado ‚Äî verifique sua caixa de entrada.</div><div class="modal-btns"><button class="btn-sec">Cancelar</button><button class="btn-comprar" style="margin:0">Enviar link</button></div></div></div><div class="hero"><div class="hero-badge">Vers√£o 2026 ¬∑ Automatize agora</div><h1>Emita guias DAS<br>para todos os seus<br><em>MEIs em segundos</em></h1><p>Automa√ß√£o direta no navegador ‚Äî sem planilhas, sem portais lentos. Controle todos os seus clientes em um s√≥ lugar.</p><div class="hero-features"><div class="hero-feat">Download autom√°tico</div><div class="hero-feat">100% no navegador</div><div class="hero-feat">Gest√£o de CNPJs</div><div class="hero-feat">Suporte WhatsApp</div></div></div><div class="billing-cycle-section"><div class="billing-cycle-container"><button class="billing-cycle-btn active" data-cycle="monthly">Mensal</button><button class="billing-cycle-btn" data-cycle="quarterly">
 Trimestral <span class="discount-badge">10% OFF</span></button><button class="billing-cycle-btn" data-cycle="semiannual">
 Semestral <span class="discount-badge">20% OFF</span></button><button class="billing-cycle-btn" data-cycle="annual">
 Anual <span class="discount-badge">30% OFF</span></button></div></div><div class="plans-section"><p class="section-label">‚óÜ Escolha seu plano</p><div class="plans" id="plans-container"><!-- monthly: 19,90 | quarterly(3x*0,9): 53,73 | semiannual(6x*0,8): 95,52 | annual(12x*0,7): 167,16 --><div class="plan-card" data-slug="starter"
 data-price-monthly="19,90" data-price-quarterly="53,73" data-price-semiannual="95,52" data-price-annual="167,16"
 data-limit="20"><div class="plan-check"></div><div class="plan-name">Starter</div><div class="plan-limit">at√© 20 CNPJs/m√™s</div><div class="plan-price">R$ 19<span>,90</span></div><div class="plan-billing">por m√™s</div></div><!-- monthly: 39,90 | quarterly: 107,73 | semiannual: 191,52 | annual: 335,16 --><div class="plan-card" data-slug="basic"
 data-price-monthly="39,90" data-price-quarterly="107,73" data-price-semiannual="191,52" data-price-annual="335,16"
 data-limit="50"><div class="plan-check"></div><div class="plan-name">Basic</div><div class="plan-limit">at√© 50 CNPJs/m√™s</div><div class="plan-price">R$ 39<span>,90</span></div><div class="plan-billing">por m√™s</div></div><!-- monthly: 49,90 | quarterly: 134,73 | semiannual: 239,52 | annual: 419,16 --><div class="plan-card" data-slug="pro"
 data-price-monthly="49,90" data-price-quarterly="134,73" data-price-semiannual="239,52" data-price-annual="419,16"
 data-limit="80"><div class="plan-check"></div><div class="popular-tag">‚òÖ Popular</div><div class="plan-name">Pro</div><div class="plan-limit">at√© 80 CNPJs/m√™s</div><div class="plan-price">R$ 49<span>,90</span></div><div class="plan-billing">por m√™s</div></div><!-- monthly: 59,90 | quarterly: 161,73 | semiannual: 287,52 | annual: 503,16 --><div class="plan-card" data-slug="advanced"
 data-price-monthly="59,90" data-price-quarterly="161,73" data-price-semiannual="287,52" data-price-annual="503,16"
 data-limit="100"><div class="plan-check"></div><div class="plan-name">Advanced</div><div class="plan-limit">at√© 100 CNPJs/m√™s</div><div class="plan-price">R$ 59<span>,90</span></div><div class="plan-billing">por m√™s</div></div><!-- monthly: 99,90 | quarterly: 269,73 | semiannual: 479,52 | annual: 839,16 --><div class="plan-card" data-slug="business"
 data-price-monthly="99,90" data-price-quarterly="269,73" data-price-semiannual="479,52" data-price-annual="839,16"
 data-limit="200"><div class="plan-check"></div><div class="plan-name">Business</div><div class="plan-limit">at√© 200 CNPJs/m√™s</div><div class="plan-price">R$ 99<span>,90</span></div><div class="plan-billing">por m√™s</div></div><!-- monthly: 199,90 | quarterly: 539,73 | semiannual: 959,52 | annual: 1.679,16 --><div class="plan-card" data-slug="enterprise"
 data-price-monthly="199,90" data-price-quarterly="539,73" data-price-semiannual="959,52" data-price-annual="1.679,16"
 data-limit="500"><div class="plan-check"></div><div class="plan-name">Enterprise</div><div class="plan-limit">at√© 500 CNPJs/m√™s</div><div class="plan-price">R$ 199<span>,90</span></div><div class="plan-billing">por m√™s</div></div><!-- monthly: 199,90 | quarterly: 539,73 | semiannual: 959,52 | annual: 1.679,16 --><div class="plan-card personalizado" data-slug="personalizado"
 data-price-monthly="199,90" data-price-quarterly="539,73" data-price-semiannual="959,52" data-price-annual="1.679,16"
 data-limit="9999"><div class="plan-check"></div><div class="custom-tag">‚ú¶ Personalizado</div><div class="plan-name">Custom</div><div class="plan-limit">501+ CNPJs/m√™s</div><div class="plan-price" id="custom-price">R$ 199<span>,90</span></div><div class="plan-billing" id="custom-billing">fixo/m√™s</div><div class="plan-overage" id="custom-overage">+ R$0,25 por CNPJ acima de 500</div></div></div></div></div><div class="sep"><span>Seus dados</span></div><div class="form-section"><div class="form-card"><div class="form-title"><div class="form-title-icon">üìã</div>
 Complete seu cadastro
 </div><div id="plano-escolhido" style="display:none" class="plano-selecionado"><span>Plano selecionado</span><strong><span id="plano-nome-display">‚Äî</span> ¬∑ R$ <span id="plano-preco-display">‚Äî</span>/<span id="plano-ciclo-display">m√™s</span></strong></div><!-- Aviso plano personalizado --><div id="aviso-personalizado" class="aviso-personalizado" style="display:none"><strong>‚ú¶ Plano Personalizado ‚Äî 501+ CNPJs</strong><br><br>
 Este plano √© configurado sob medida para seu volume.<br><br>
 üí∞ <span id="custom-aviso-preco"><strong>R$199,90/m√™s</strong> base + <strong>R$0,25 por CNPJ</strong> acima de 500</span><br>
 üìÖ Descontos: 10% trimestral ¬∑ 20% semestral ¬∑ 30% anual<br><br>
 Entre em contato pelo WhatsApp para configurar seu plano:
 <a class="btn-wpp" href="https://wa.me/5500000000000?text=Ol√°!%20Quero%20contratar%20o%20Plano%20Personalizado%20do%20PGMEI%20Automa√ß√£o%20(501%2B%20CNPJs)" target="_blank">
 üí¨ Falar no WhatsApp
 </a></div><div id="aviso-email-existente" class="aviso-email" style="display:none">
 ‚ö† Este email j√° possui uma conta.<br><span class="link" data-action="abrir-modal">Esqueceu sua senha?</span>
 &nbsp;¬∑&nbsp;
 <span class="link" data-action="retornar-portal">Gerenciar assinatura</span></div><div id="form-campos"><div class="form-group"><label>Nome completo</label><input type="text" id="input-nome" placeholder="Seu nome completo"></div><div class="form-group"><label>Email ‚Äî seu login na extens√£o</label><input type="email" id="input-email" placeholder="seuemail@exemplo.com"></div><div style="background:rgba(240,165,0,0.07);border:1px solid rgba(240,165,0,0.25);border-radius:10px;padding:14px 16px;margin-bottom:18px;font-size:13px;color:#f5d070;line-height:1.6;">
 üîê <strong>Sem senha por enquanto!</strong><br>
 Ap√≥s o pagamento, voc√™ receber√° um <strong>e-mail autom√°tico</strong> com um link para criar sua senha e acessar a extens√£o.
</div><div class="form-group"><div class="label-row"><label style="margin:0">Documento para Nota Fiscal</label><span class="label-optional">opcional</span></div><div class="doc-tabs" style="margin-top:8px"><div class="doc-tab active" id="tab-cnpj">CNPJ</div><div class="doc-tab" id="tab-cpf">CPF</div></div><input type="text" id="input-doc" placeholder="Deixe em branco se n√£o quiser" maxlength="18"></div><hr class="divider"><div id="erro-form" class="erro"></div><input type="text" id="hp-field" name="website" style="display:none !important" tabindex="-1" autocomplete="off"><div style="display:flex; gap:10px; align-items:flex-start; margin-bottom:12px;"><input type="checkbox" id="aceite-termos" style="width:auto; margin-top:3px;"><label for="aceite-termos" style="font-size:13px; color:#94a3b8; cursor:pointer;">
 Li e concordo com os
 <a href="/termos.html" target="_blank" style="color:#8b5cf6;">Termos de Uso</a>
 e a
 <a href="/termos.html" target="_blank" style="color:#8b5cf6;">Pol√≠tica de Privacidade</a></label></div><button class="btn-comprar" id="btn-comprar">Assinar agora</button><div style="text-align:center; margin-top:14px;"><span class="link" data-action="abrir-modal">Esqueci minha senha</span></div><div class="seguro">üîí Pagamento via Stripe &nbsp;¬∑&nbsp; Cancele quando quiser</div></div></div></div><div class="page-footer">PGMEI Automa√ß√£o 2026 &nbsp;¬∑&nbsp; Todos os direitos reservados</div><!-- VULN-008: Stripe.js carregado sem SRI. O Stripe atualmente n√£o publica
     hashes SRI oficiais para js.stripe.com/v3/. Quando estiverem dispon√≠veis,
     adicionar: integrity="sha384-HASH_AQUI" crossorigin="anonymous"
     Monitorar: https://stripe.com/docs/security/guide -->
<script src="https://js.stripe.com/v3/" crossorigin="anonymous"></script><script>
// VUL-04 CORRIGIDO: trocar pk_test_ pela pk_live_ de produ√ß√£o
// Substitua pela chave public√°vel de produ√ß√£o: Stripe Dashboard ‚Üí Developers ‚Üí API Keys
const STRIPE_PUBLIC_KEY = 'pk_live_SUBSTITUA_PELA_CHAVE_PUBLICAVEL_PRODUCAO';
const SUPABASE_URL = 'https://kzhoezukwpllgcxzkkbr.supabase.co';
// VULN-001 CORRIGIDO: Regenerar esta chave no Supabase Dashboard (Settings ‚Üí API)
// com prazo de expira√ß√£o de 1-2 anos e atualizar aqui + popup.js + background.js.
// A chave atual expira em 2087 ‚Äî validade inaceit√°vel.
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt6aG9lenVrd3BsbGdjeHpra2JyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2MzM5NTAsImV4cCI6MjA4NzIwOTk1MH0.AkahuDsRBgXKKAnbt7bN-eeGA-i6pC3kfhcvk-8p5VY'; // Project Settings ‚Üí API ‚Üí anon public
const stripe = Stripe(STRIPE_PUBLIC_KEY);

let planoSelecionado = null;
let cicloSelecionado = 'monthly';
let tipoDoc = 'cnpj';

// ‚îÄ‚îÄ PRICE IDS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Substitua os placeholders pelos IDs reais do Stripe ap√≥s criar os pre√ßos
const PRICE_IDS = {
 starter: {
 monthly: 'price_1T1VCcDlcKI1dmuMYgSnIDTp',
 quarterly: 'price_1T3LC1DlcKI1dmuM9AddZfwA',
 semiannual: 'price_1T3LC1DlcKI1dmuMwSIPqElk',
 annual: 'price_1T3LC1DlcKI1dmuMBBH6bhtX'
 },
 basic: {
 monthly: 'price_1T1VDEDlcKI1dmuMF37skYlk',
 quarterly: 'price_1T3LCkDlcKI1dmuM1VPpI9VX',
 semiannual: 'price_1T3LCkDlcKI1dmuMnrGq2xnW',
 annual: 'price_1T3LCkDlcKI1dmuMhnliCQ6t'
 },
 pro: {
 monthly: 'price_1T1VDYDlcKI1dmuMC1e6SFbf',
 quarterly: 'price_1T3LDUDlcKI1dmuMXCm8xkpj',
 semiannual: 'price_1T3LDUDlcKI1dmuMGxdxvUcM',
 annual: 'price_1T3LDUDlcKI1dmuMg78FWJR8'
 },
 advanced: {
 monthly: 'price_1T1VDsDlcKI1dmuMOUN9SPtl',
 quarterly: 'price_1T3LE6DlcKI1dmuMUJcYxAHN',
 semiannual: 'price_1T3LE6DlcKI1dmuMGs4bcraB',
 annual: 'price_1T3LE6DlcKI1dmuMrzlFsbgO'
 },
 business: {
 monthly: 'price_1T1VF2DlcKI1dmuMBqzA5rWu',
 quarterly: 'price_1T3LEgDlcKI1dmuMdC7itqYY',
 semiannual: 'price_1T3LEgDlcKI1dmuMbxeNmzjN',
 annual: 'price_1T3LEgDlcKI1dmuMdLFE8m2t'
 },
 enterprise: {
 monthly: 'price_1T3S35DlcKI1dmuMH0YxaHID',
 quarterly: 'price_1T3LG2DlcKI1dmuMHCHaBnF3',
 semiannual: 'price_1T3LG2DlcKI1dmuMl913tuoP',
 annual: 'price_1T3LG2DlcKI1dmuM524O7B0f'
 }
};

const DISCOUNT_TEXT = {
 monthly: { billing: 'por m√™s', saving: null },
 quarterly: { billing: 'a cada 3 meses', saving: 'Economize 10%' },
 semiannual: { billing: 'a cada 6 meses', saving: 'Economize 20%' },
 annual: { billing: 'por ano', saving: 'Economize 30%' }
};

const CUSTOM_PRICING = {
 monthly: { base: '199<span>,90</span>', billing: 'fixo/m√™s', overage: '+ R$0,25 por CNPJ acima de 500', aviso: '<strong>R$199,90/m√™s</strong> base + <strong>R$0,25/CNPJ</strong> acima de 500' },
 quarterly: { base: '539<span>,73</span>', billing: 'fixo a cada 3 meses', overage: '+ R$0,675 por CNPJ acima de 500', aviso: '<strong>R$539,73/trimestre</strong> base (R$179,91/m√™s) + <strong>R$0,675/CNPJ</strong> acima de 500 por trimestre (R$0,225/m√™s)' },
 semiannual: { base: '959<span>,52</span>', billing: 'fixo a cada 6 meses', overage: '+ R$1,20 por CNPJ acima de 500', aviso: '<strong>R$959,52/semestre</strong> base (R$159,92/m√™s) + <strong>R$1,20/CNPJ</strong> acima de 500 por semestre (R$0,20/m√™s)' },
 annual: { base: '1.679<span>,16</span>', billing: 'fixo por ano', overage: '+ R$2,10 por CNPJ acima de 500', aviso: '<strong>R$1.679,16/ano</strong> base (R$139,93/m√™s) + <strong>R$2,10/CNPJ</strong> acima de 500 por ano (R$0,175/m√™s)' }
};

function atualizarCardCustom() {
 const cp = CUSTOM_PRICING[cicloSelecionado];
 const card = document.querySelector('.plan-card.personalizado');
 if (!card) return;
 document.getElementById('custom-price').innerHTML = `R$ ${cp.base}`;
 document.getElementById('custom-billing').textContent = cp.billing;
 document.getElementById('custom-overage').textContent = cp.overage;
 const savingsEl = card.querySelector('.plan-savings');
 if (DISCOUNT_TEXT[cicloSelecionado].saving) {
 if (!savingsEl) {
 const div = document.createElement('div');
 div.className = 'plan-savings';
 div.textContent = DISCOUNT_TEXT[cicloSelecionado].saving + ' na base';
 card.appendChild(div);
 } else { savingsEl.style.display='block'; savingsEl.textContent = DISCOUNT_TEXT[cicloSelecionado].saving + ' na base'; }
 } else {
 if (savingsEl) savingsEl.style.display='none';
 }
 // Atualiza aviso se estiver vis√≠vel
 const avisoPreco = document.getElementById('custom-aviso-preco');
 if (avisoPreco) avisoPreco.innerHTML = `üí∞ ${cp.aviso}`;
}

function selecionarCiclo(btn) {
 document.querySelectorAll('.billing-cycle-btn').forEach(b => b.classList.remove('active'));
 btn.classList.add('active');
 cicloSelecionado = btn.dataset.cycle;

 document.querySelectorAll('.plan-card').forEach(card => {
 if (card.dataset.slug === 'personalizado') return;
 const keyMap = { monthly:'priceMonthly', quarterly:'priceQuarterly', semiannual:'priceSemiannual', annual:'priceAnnual' };
 const price = card.dataset[keyMap[cicloSelecionado]];
 const priceEl = card.querySelector('.plan-price');
 const billingEl = card.querySelector('.plan-billing');
 const savingsEl = card.querySelector('.plan-savings');
 const [reais, centavos] = price.split(',');
 priceEl.innerHTML = `R$ ${reais}<span>,${centavos}</span>`;
 billingEl.textContent = DISCOUNT_TEXT[cicloSelecionado].billing;
 if (DISCOUNT_TEXT[cicloSelecionado].saving) {
 if (!savingsEl) {
 const div = document.createElement('div');
 div.className = 'plan-savings';
 div.textContent = DISCOUNT_TEXT[cicloSelecionado].saving;
 card.appendChild(div);
 } else { savingsEl.style.display='block'; savingsEl.textContent = DISCOUNT_TEXT[cicloSelecionado].saving; }
 } else {
 if (savingsEl) savingsEl.style.display='none';
 }
 });

 atualizarCardCustom();

 if (planoSelecionado && planoSelecionado.slug !== 'personalizado') {
 const card = document.querySelector(`.plan-card[data-slug="${planoSelecionado.slug}"]`);
 if (card) selecionarPlano(card);
 }
}

function selecionarPlano(el) {
 document.querySelectorAll('.plan-card').forEach(c => {
 c.classList.remove('selected');
 c.querySelector('.plan-check').textContent = '';
 });
 el.classList.add('selected');
 el.querySelector('.plan-check').textContent = '‚úì';

 const slug = el.dataset.slug;

 // Plano personalizado ‚Äî mostra aviso especial
 if (slug === 'personalizado') {
 atualizarCardCustom();
 const cp = CUSTOM_PRICING[cicloSelecionado];
 document.getElementById('custom-aviso-preco').innerHTML = cp.aviso;
 document.getElementById('aviso-personalizado').style.display = 'block';
 document.getElementById('plano-escolhido').style.display = 'none';
 document.getElementById('btn-comprar').style.display = 'none';
 planoSelecionado = { slug: 'personalizado', name: 'Custom', cycle: cicloSelecionado };
 document.getElementById('erro-form').textContent = '';
 return;
 }

 // Planos normais
 document.getElementById('aviso-personalizado').style.display = 'none';
 document.getElementById('btn-comprar').style.display = 'block';

 const keyMap = { monthly:'priceMonthly', quarterly:'priceQuarterly', semiannual:'priceSemiannual', annual:'priceAnnual' };
 const price = el.dataset[keyMap[cicloSelecionado]];
 const [reais, centavos] = price.split(',');

 planoSelecionado = {
 slug: slug,
 priceId: PRICE_IDS[slug][cicloSelecionado],
 price: price,
 limit: el.dataset.limit,
 name: el.querySelector('.plan-name').textContent,
 cycle: cicloSelecionado
 };

 document.getElementById('plano-escolhido').style.display = 'flex';
 document.getElementById('plano-nome-display').textContent = planoSelecionado.name;
 document.getElementById('plano-preco-display').textContent = price;

 const cicloTexts = { monthly: 'm√™s', quarterly: '3 meses', semiannual: '6 meses', annual: 'ano' };
 const cicloText = cicloTexts[cicloSelecionado];
 document.getElementById('plano-ciclo-display').textContent = cicloText;
 document.getElementById('erro-form').textContent = '';

 document.getElementById('btn-comprar').textContent = cicloSelecionado === 'monthly'
 ? `Assinar ${planoSelecionado.name} ‚Äî R$ ${price}/m√™s`
 : `Assinar ${planoSelecionado.name} ‚Äî R$ ${price}/${cicloText}`;
}

function trocarDoc(tipo) {
 tipoDoc = tipo;
 document.getElementById('tab-cnpj').classList.toggle('active', tipo === 'cnpj');
 document.getElementById('tab-cpf').classList.toggle('active', tipo === 'cpf');
 document.getElementById('input-doc').maxLength = tipo === 'cnpj' ? 18 : 14;
 document.getElementById('input-doc').value = '';
}

 

function mostrarErro(msg) { document.getElementById('erro-form').textContent = msg; }
function esconderAvisoEmail() { document.getElementById('aviso-email-existente').style.display = 'none'; }
// VUL-04/14 CORRIGIDO: substituir pela URL do Customer Portal de PRODU√á√ÉO do Stripe.
// A URL 'test_...' abaixo √© do ambiente de testes ‚Äî clientes reais n√£o conseguem
// acessar suas assinaturas por ela. Substitua pela URL do painel Stripe de produ√ß√£o:
// Stripe Dashboard ‚Üí Billing ‚Üí Customer Portal ‚Üí Launch customer portal ‚Üí copiar link
function retornarParaPortal() { window.open('https://billing.stripe.com/p/login/SUBSTITUA_PELA_URL_PRODUCAO', '_blank'); }
function abrirModal() {
 const email = document.getElementById('input-email').value.trim();
 if (email) document.getElementById('modal-email').value = email;
 document.getElementById('modal-senha').classList.add('aberto');
 document.getElementById('modal-erro').textContent = '';
 document.getElementById('modal-sucesso').style.display = 'none';
}
function fecharModal() { document.getElementById('modal-senha').classList.remove('aberto'); }

async function enviarRecuperacao() {
 const email = document.getElementById('modal-email').value.trim();
 const erroEl = document.getElementById('modal-erro');
 erroEl.textContent = '';
 if (!email) { erroEl.textContent = 'Digite seu email.'; return; }
 try {
 const res = await fetch(`${SUPABASE_URL}/functions/v1/recover-password`, {
 method: 'POST',
 headers: {
 'Content-Type': 'application/json',
 'apikey': SUPABASE_ANON_KEY,
 'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
 },
 body: JSON.stringify({ email })
 });
 const data = await res.json();
 if (data.error) erroEl.textContent = '‚úï ' + data.error;
 else { document.getElementById('modal-sucesso').style.display = 'block'; setTimeout(fecharModal, 3000); }
 } catch { erroEl.textContent = 'Erro de conex√£o. Tente novamente.'; }
}

function validarEmail(email) { return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email); }

// VUL-09 / V3-05 CORRIGIDO: valida√ß√£o com d√≠gitos verificadores (M√≥dulo 11),
// n√£o apenas comprimento. Portado do validate.ts do backend.
function cnpjValido(cnpj) {
  if (cnpj.length !== 14 || /^(\d)\1+$/.test(cnpj)) return false;
  const calc = (str, p) => { let soma=0,peso=p; for(let i=0;i<str.length-1;i++){soma+=+str[i]*peso--;if(peso<2)peso=9;} const r=soma%11; return r<2?0:11-r; };
  return +cnpj[12]===calc(cnpj.slice(0,12)+'00',5) && +cnpj[13]===calc(cnpj.slice(0,13)+'0',6);
}
function cpfValido(cpf) {
  if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
  const calc = (str, p) => { let soma=0; for(let i=0;i<str.length;i++){soma+=+str[i]*(p-i);} const r=(soma*10)%11; return (r===10||r===11)?0:r; };
  return +cpf[9]===calc(cpf.slice(0,9),10) && +cpf[10]===calc(cpf.slice(0,10),11);
}

async function iniciarCompra() {
 mostrarErro('');
 if (document.getElementById('hp-field').value) return;
 if (!document.getElementById('aceite-termos').checked) {
 mostrarErro('‚ö†Ô∏è Voc√™ precisa aceitar os Termos de Uso para continuar.'); return;
 }
 const nome = document.getElementById('input-nome').value.trim();
 const email = document.getElementById('input-email').value.trim();
 const doc = document.getElementById('input-doc').value.trim().replace(/\D/g, '');

 if (!planoSelecionado) { mostrarErro('‚ö† Selecione um plano acima.'); return; }
 if (!nome) { mostrarErro('‚ö† Preencha seu nome.'); return; }
 if (!validarEmail(email)) { mostrarErro('‚ö† Email inv√°lido.'); return; }
  if (doc.length > 0) {
    if (tipoDoc === 'cnpj' && (doc.length !== 14 || !cnpjValido(doc))) { mostrarErro('‚ö† CNPJ inv√°lido. Verifique os d√≠gitos ou deixe em branco.'); return; }
    if (tipoDoc === 'cpf'  && (doc.length !== 11 || !cpfValido(doc)))  { mostrarErro('‚ö† CPF inv√°lido. Verifique os d√≠gitos ou deixe em branco.'); return; }



 }

 const btn = document.getElementById('btn-comprar');
 btn.disabled = true; btn.textContent = '‚è≥ Processando...';

 try {
 const res = await fetch(`${SUPABASE_URL}/functions/v1/create-checkout`, {
 method: 'POST',
 headers: {
 'Content-Type': 'application/json',
 'apikey': SUPABASE_ANON_KEY,
 'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
 },
 body: JSON.stringify({
 email, nome,
 documento: doc || null,
 tipo_documento: doc ? tipoDoc : null,
 price_id: planoSelecionado.priceId,
 plan_slug: planoSelecionado.slug,
 billing_cycle: planoSelecionado.cycle
 })
 });
 const resultado = await res.json();

 if (resultado.error) {
 if (resultado.error.toLowerCase().includes('already')) {
 document.getElementById('aviso-email-existente').style.display = 'block';
 document.getElementById('input-email').classList.add('erro-campo');
 btn.disabled = false;
 const cicloTexts = { monthly: 'm√™s', quarterly: '3 meses', semiannual: '6 meses', annual: 'ano' };
 btn.textContent = cicloSelecionado === 'monthly'
 ? `Assinar ${planoSelecionado.name} ‚Äî R$ ${planoSelecionado.price}/m√™s`
 : `Assinar ${planoSelecionado.name} ‚Äî R$ ${planoSelecionado.price}/${cicloTexts[cicloSelecionado]}`;
 return;
 }
 throw new Error(resultado.error);
 }
 await stripe.redirectToCheckout({ sessionId: resultado.sessionId });

 } catch (err) {
 mostrarErro('‚úï ' + (err.message || 'Erro ao processar. Tente novamente.'));
 btn.disabled = false;
 const cicloTexts = { monthly: 'm√™s', quarterly: '3 meses', semiannual: '6 meses', annual: 'ano' };
 btn.textContent = planoSelecionado && cicloSelecionado === 'monthly'
 ? `Assinar ${planoSelecionado.name} ‚Äî R$ ${planoSelecionado.price}/m√™s`
 : `Assinar ${planoSelecionado.name} ‚Äî R$ ${planoSelecionado.price}/${cicloTexts[cicloSelecionado]}`;
 }
}

document.getElementById('modal-senha').addEventListener('click', function(e) {
 if (e.target === this) fecharModal();
});

// ‚îÄ‚îÄ VULN-009 CORRIGIDO: substituir todos os handlers inline (onclick/oninput)
// por addEventListener, compat√≠vel com CSP sem 'unsafe-inline' em script-src.
// Os atributos onclick foram removidos dos elementos HTML acima e registrados aqui.
document.querySelectorAll('.billing-cycle-btn').forEach(btn => {
  btn.addEventListener('click', () => selecionarCiclo(btn));
});
document.querySelectorAll('.plan-card').forEach(card => {
  card.addEventListener('click', () => selecionarPlano(card));
});
document.getElementById('tab-cnpj').addEventListener('click', () => trocarDoc('cnpj'));
document.getElementById('tab-cpf').addEventListener('click',  () => trocarDoc('cpf'));
document.getElementById('btn-comprar').addEventListener('click', iniciarCompra);
document.querySelector('.modal-btns .btn-sec').addEventListener('click', fecharModal);
document.querySelector('.modal-btns .btn-comprar').addEventListener('click', enviarRecuperacao);
document.querySelectorAll('[data-action="abrir-modal"]').forEach(el => {
  el.addEventListener('click', abrirModal);
});
document.querySelectorAll('[data-action="retornar-portal"]').forEach(el => {
  el.addEventListener('click', retornarParaPortal);
});
document.getElementById('input-email').addEventListener('input', esconderAvisoEmail);
</script></body></html>